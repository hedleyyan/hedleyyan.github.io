<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: tips | Hedley]]></title>
  <link href="http://hedleyyan.github.io/tags/tips/atom.xml" rel="self"/>
  <link href="http://hedleyyan.github.io/"/>
  <updated>2021-02-04T13:19:33+08:00</updated>
  <id>http://hedleyyan.github.io/</id>
  <author>
    <name><![CDATA[hedley]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[OS X é€šè¿‡å‘½ä»¤è¡Œè®¾ç½®ç‰¹å®š IP]]></title>
    <link href="http://hedleyyan.github.io/blog/2016/10/10/os-x-ming-ling-xing-she-ding-zhi-ding-ip/"/>
    <updated>2016-10-10T22:07:02+08:00</updated>
    <id>http://hedleyyan.github.io/blog/2016/10/10/os-x-ming-ling-xing-she-ding-zhi-ding-ip</id>
    <content type="html"><![CDATA[<h2>æ­£æ–‡</h2>

<p>ç”±äºæˆ‘è‡ªå·±æœºå™¨ä¸Šçš„æœåŠ¡å™¨é…ç½®ï¼Œåˆ°å…¬å¸è”ç½‘åï¼Œéœ€è¦æ‰‹åŠ¨è®¾ç½® IP <code>10.0.xx.xx</code>ã€‚ä¸€æ—¦å‡ºäº†å…¬å¸è¿å…¥å…¶ä»–ç½‘ç»œï¼Œåˆéœ€è¦æŠŠ IP æ”¹ä¸ºè‡ªåŠ¨è·å¾—ã€‚é€šå¸¸æ“ä½œé¡ºåºæ˜¯ <code>ç³»ç»Ÿåå¥½è®¾ç½® -&gt; ç½‘ç»œ -&gt; Wi-Fi -&gt; é«˜çº§ -&gt; TCP/IP -&gt; ä½¿ç”¨ DHCP</code>ï¼Œå¾ˆéº»çƒ¦ã€‚</p>

<p>æŸ¥é˜…äº†ä¸€äº›èµ„æ–™ï¼ŒMac OS X å…¶å®å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæ¥æ‰§è¡Œï¼š</p>

<ul>
<li><code>sudo networksetup -setmanualwithdhcprouter Wi-Fi 10.0.xx.xx</code> - æ‰‹åŠ¨è®¾ç½® IP</li>
<li><code>sudo networksetup -setdhcp Wi-Fi</code> - è‡ªåŠ¨è·å¾— IP</li>
</ul>


<p>å¯ä»¥å†™å…¥è„šæœ¬ï¼Œé…åˆ <a href="https://www.alfredapp.com/">Alfred</a> çš„ Workflows åŠŸèƒ½æ›´èµã€‚</p>

<h2>å¼•ç”¨</h2>

<p><a href="https://developer.apple.com/legacy/library/documentation/Darwin/Reference/ManPages/man8/networksetup.8.html">OS X Man Pages</a></p>

<p><a href="http://serverfault.com/questions/638949/os-x-command-line-ipv4-interface-reset">OS X Command Line IPv4 interface Reset</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[HotSpot JVM è°ƒè¯•å¤§æ‚çƒ©]]></title>
    <link href="http://hedleyyan.github.io/blog/2016/09/21/jvm-diao-shi-da-za-hui/"/>
    <updated>2016-09-21T11:19:33+08:00</updated>
    <id>http://hedleyyan.github.io/blog/2016/09/21/jvm-diao-shi-da-za-hui</id>
    <content type="html"><![CDATA[<p><blockquote><p>æ­¤æ–‡çš„ JVM ç¯å¢ƒç‰¹æŒ‡ HotSpot JVM</p></blockquote></p>

<h2><a href="http://xmlandmore.blogspot.hk/2012/01/understanding-garbage-collection.html">Understanding Garbage Collection</a></h2>

<p>äº†è§£ JVM å†…å­˜å›æ”¶æœºåˆ¶ï¼Œä»¥åŠå¹´è½»ä»£ã€ä¼Šç”¸å›­ã€å¹´è€ä»£çš„æ„ä¹‰ã€‚<a href="http://xmlandmore.blogspot.hk/2012/03/case-study-of-javalangoutofmemoryerror.html">Full GC</a> å‘ç”Ÿå¾ˆé¢‘ç¹æ—¶ï¼Œå…³æ³¨æ˜¯å¦åˆ†é…å†…å­˜ä¸è¶³<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>ã€æ­»é”ã€æˆ–è€…å†…å­˜æ³„éœ²ã€‚</p>

<ul>
<li><a href="http://xmlandmore.blogspot.hk/2012/03/understanding-garbage-collector-output.html">Understanding Garbage Collector Output of Hotspot VM</a></li>
</ul>


<h2><a href="http://xmlandmore.blogspot.hk/2012/07/jstat-java-virtual-machine-statistics.html">jstat</a> - Statistics Monitoring</h2>

<p>ä¸€ç³»åˆ—è°ƒè¯•é€‰é¡¹ï¼Œå¸¸ç”¨ <code>jstat -gcutil</code> æ’æŸ¥å†…å­˜é—®é¢˜ã€‚</p>

<h2><a href="http://xmlandmore.blogspot.hk/2013/04/analyze-hanging-programs-using-java.html">jstack</a> - Stack Trace</h2>

<ul>
<li><a href="http://xmlandmore.blogspot.hk/2012/08/understanding-jvm-thread-states.html">Generating Thread Dumps in HotSpot</a> - ç­‰åŒäº <code>jstack [PID] &gt; threaddump.log</code></li>
<li><a href="http://geekexplains.blogspot.hk/2008/07/threadstate-in-java-blocked-vs-waiting.html">Thread.State in Java? BLOCKED vs WAITING</a></li>
<li><a href="https://community.oracle.com/blogs/sdo/2009/10/16/fun-jstack">Fun With JStack Blog</a></li>
<li><a href="http://stackoverflow.com/questions/28378592/java-thread-state-transition-waiting-to-blocked-or-runnable">Java thread state transition, WAITING to BLOCKED, or RUNNABLE?</a></li>
</ul>


<p>äº†è§£ä¸åŒçš„çº¿ç¨‹çŠ¶æ€ã€‚é€šå¸¸ç”¨æ¥æ’æŸ¥æ˜¯å¦æœ‰æ­»é”å‘ç”Ÿï¼Œä»¥åŠæ‰¾å‡ºé«˜ CPU æ¶ˆè€—çš„çº¿ç¨‹çŠ¶æ€ã€‚</p>

<ul>
<li><code>top -Hp [PID]</code> - æ‰¾å‡ºè¿›ç¨‹å†…æœ€è€—è´¹CPUçš„çº¿ç¨‹</li>
<li><code>printfÂ "%x\n"Â [PID]</code> - å¾—åˆ°çº¿ç¨‹å· TID</li>
<li><code>jstackÂ [PID]Â |Â grepÂ [TID]</code> - è§‚å¯Ÿçº¿ç¨‹ä¿¡æ¯</li>
</ul>


<p><img src="/images/JVM/states_trans.png"></p>

<h2><a href="http://xmlandmore.blogspot.hk/2013/08/diagnosing-outofmemoryerror-or-memory_10.html">jmap</a> - Memory Map</h2>

<p>åˆ†æ JVM çš„å†…å­˜çŠ¶æ€ï¼Œæ˜¯æ’æŸ¥å†…å­˜æ³„éœ²çš„å…³é”®ã€‚</p>

<ul>
<li><code>jmap -heap [PID]</code> - è¿›ç¨‹å †å†…å­˜ä½¿ç”¨æƒ…å†µ</li>
<li><code>jmap -histo[:live] [PID] | head 15</code> - å¯¹è±¡å ç”¨å›¾ã€‚å¯¹è±¡å ç”¨å›¾ç²’åº¦å¾ˆç²—ï¼Œæ— æ³•è·å¾—æ›´è¯¦ç»†çš„å¯¹è±¡çŠ¶æ€</li>
<li><code>jmapÂ -dump:format=b,file=dump.hprof [PID]</code> - ç”Ÿæˆ <em>dump.hprof</em> æ–‡ä»¶ã€‚æ‰§è¡Œæ—¶é—´ç¨é•¿ï¼ŒåŸºäºæ­¤å¯è¿›è¡Œè¿›ä¸€æ­¥çš„ç²¾å‡†åˆ†æ</li>
</ul>


<h4><a href="http://xmlandmore.blogspot.hk/2014/01/eclipse-mat-understand-incoming-and.html">Eclipse MAT</a></h4>

<p>åŸºäº <em>dump.hprof</em> è¿›è¡Œåˆ†æï¼Œé¦–é€‰ä¸»æµå·¥å…· <em>Eclipse MAT</em>ã€‚<em>MAT</em> å¯ä»¥å¼€ä¸Šå¸è§†è§’ï¼Œé€šè¿‡ <a href="http://xmlandmore.blogspot.hk/2014/01/eclipse-mat-querying-heap-objects-using.html">OQL</a> ç²¾ç¡®å®šä½åˆ°æ¯ä¸ªå¯¹è±¡ï¼Œç”¨æ¥åšè¯¦ç»†çš„åˆ†ææŒ–æ˜å¾ˆå¥½ç”¨ã€‚ä¸è¿‡å®ƒçš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼šé‡é‡çº§ã€‚å¦‚æœ dump æ–‡ä»¶ä¸å¤§ï¼Œç›´æ¥ç”¨ <em>MAT</em> åˆ†ææ²¡æœ‰é—®é¢˜ã€‚ä½†ç°å®è¿è¡Œç¯å¢ƒä¸­ï¼Œdump æ–‡ä»¶é€šå¸¸å¾ˆå¤§<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>ï¼Œä¸€èˆ¬éœ€è¦é¢ä¸´ä»¥ä¸‹é—®é¢˜ï¼šä»æœåŠ¡å™¨å‹ç¼©ä¼ è¾“åˆ°ä¸ªäººæœºå™¨ï¼Œå‹ç¼©å’Œä¼ è¾“çš„æ—¶é—´æˆæœ¬å¾ˆé«˜ï¼›è§£å‹ç¼©åç”¨ <em>MAT</em> å¯¼å…¥ï¼Œå¦‚æœä¸ªäººæœºå™¨çš„å†…å­˜ä¸å¤Ÿï¼Œæ— æ³•è¿›è¡Œè§£æ<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>ã€‚</p>

<h5><a href="https://wiki.eclipse.org/MemoryAnalyzer/FAQ#Frequently_Asked_Questions">å†…å­˜ä¸å¤Ÿè£…è¿› Eclipse çš„è§£å†³æ–¹æ¡ˆ</a></h5>

<p>æ‰¾åˆ° <code>org.eclipse.equinox.launcher_1*.jar</code> çš„æœ¬åœ°ç›®å½•ï¼Œå‘½ä»¤è¡Œæ‰§è¡Œç”Ÿæˆç´¢å¼•è¿‡ç¨‹ï¼š</p>

<p><code>java -jar /Users/hedley/eclipse/java-neon/Eclipse.app/Contents/Eclipse/plugins/org.eclipse.equinox.launcher_1*.jar -consoleLog -application org.eclipse.mat.api.parse dump.hprof org.eclipse.mat.api:suspects org.eclipse.mat.api:overview org.eclipse.mat.api:top_components</code> ç”ŸæˆæŠ¥å‘Šï¼Œå…¶ä¸­ <code>org.eclipse.mat.api:suspects</code>ã€<code>org.eclipse.mat.api:overview</code>ã€<code>org.eclipse.mat.api:top_components</code> æ˜¯ç”Ÿæˆçš„ä¸‰ä¸ªä¸»è¦æ¨¡å—ï¼Œå¯æ ¹æ®éœ€è¦é…ç½®ã€‚å†ç”¨ <em>Eclipse</em> æ‰“å¼€æŠ¥å‘Šç›®å½•ã€‚</p>

<p><blockquote><p>å¦‚æœä»¥ä¸Šå‘½ä»¤è¿˜æŠ¥å†…å­˜ä¸è¶³ï¼Œå°è¯•åŠ å‚æ•° -Xmx4g -XX:-UseGCOverheadLimit</p></blockquote></p>

<p><a href="https://www.ibm.com/support/knowledgecenter/SS3KLZ/com.ibm.java.diagnostics.memory.analyzer.doc/queryingheapobjects.html">OQL2</a></p>

<h4><a href="http://dr-brenschede.de/bheapsampler/">BHeapSampler</a></h4>

<p><em>BHeapSampler</em> æ˜¯ä¸€æ¬¾è½»é‡çº§çš„ JVM å†…å­˜åˆ†æå·¥å…·ã€‚ä¸ï¼Œå®ƒä¸å•å•æ˜¯è½»é‡çº§ï¼Œæ˜¯ç¾½æ¯›çº§ï¼å¦‚æœç”¨ <em>MAT</em>ï¼Œé€šå¸¸éœ€è¦æŠŠè‡ƒè‚¿çš„ <em>dump.hprof</em> ä¼ åˆ°æœ¬æœºè¿›è¡Œæ“ä½œ<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup>ã€‚è€Œ <em>BHeapSampler</em> æ˜¯ä¸€ä¸ªå¤§å°åªæœ‰ <em><em>26K</em></em> çš„ <em>jar</em> åŒ…ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸€è¡ŒæŒ‡ä»¤å³å¯è¿›è¡Œåˆ†æã€‚å®ƒåˆ†æå¾—åˆ°çš„æ˜¯ä¸€å¼ <strong>å¤§å†…å­˜å¯¹è±¡å¼•ç”¨å›¾</strong>ï¼Œä¸èƒ½è¿›è¡Œä»»ä½•æ“ä½œä¸ç»†é¡¹æŸ¥è¯¢ç´¢å¼•ã€‚ä½†æ˜¯è¿™å¼ é‡ç‚¹é²œæ˜çš„å†…å­˜å›¾ï¼Œæœ‰æ—¶ä¼šæ¯” <em>MAT</em> æ›´å‡»ä¸­è¦å®³ã€‚å¤§å†™çš„èµã€‚</p>

<ul>
<li><code>java -Xmx40g -XX:-UseGCOverheadLimit -jar bheapsampler.jar dump.hprof</code> - å¾—åˆ° <em>memory_graph.dot</em></li>
<li>å¯ä»¥ç”¨ <a href="http://graphviz.org/Download_macos.php">Graphviz</a> æŸ¥çœ‹ <em>.dot</em> æ–‡ä»¶ï¼Œè£…å®Œä¹Ÿå¯ä»¥å°† <em>.dot</em> è½¬ä¸º <em>pdf</em> æ ¼å¼ï¼š <code>/opt/local/bin/dot -Tpdf -omemory_graph.pdf memory_graph.dot</code></li>
</ul>


<h5>Mac å®‰è£… <em>Graphviz</em></h5>

<p><img src="/images/JVM/graphviz.png"></p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>For old generation space OutOfMemoryErrors, increase -Xms and -Xmx; For permanent generation OutOfMemoryErrors, increase -XX:PermSize and -XX:MaxPermSize<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>æˆ‘æ›¾ç»åˆ†æè¿‡çš„çº¿ä¸Šå‹åŠ›ä¸€èˆ¬æœåŠ¡å™¨çš„ dump åœ¨ 10G å·¦å³<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>Eclipse åœ¨å¯¼å…¥ dump æ–‡ä»¶åï¼Œä¼šè¿›è¡Œç´¢å¼•åˆ†æï¼Œå ç”¨å¤§é‡å†…å­˜ã€‚å†…å­˜ä¸è¶³æ—¶ä¼šæŠ¥ OutOfMemoryError<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
<li id="fn:4">
<p>å¾ˆå°‘æœ‰äººåœ¨æœåŠ¡å™¨ä¸Šè£… Eclipse å§ï¼Ÿ<a href="#fnref:4" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[sed å¾ªç¯å¤„ç†]]></title>
    <link href="http://hedleyyan.github.io/blog/2015/12/27/sed-xun-huan-chu-li/"/>
    <updated>2015-12-27T17:38:03+08:00</updated>
    <id>http://hedleyyan.github.io/blog/2015/12/27/sed-xun-huan-chu-li</id>
    <content type="html"><![CDATA[<p><em>sed</em> æ˜¯ <em>shell</em> ç¼–ç¨‹ä¸­å¾ˆå¸¸è§çš„æµç¼–è¾‘å‘½ä»¤ï¼Œä¸»è¦ç”¨äºæ‰¹é‡æ›¿æ¢ã€‚</p>

<p><em>sed</em> çš„é»˜è®¤ç¼–è¾‘å•ä½æ˜¯ã€è¡Œã€ï¼Œå¦‚æœè¦å¤„ç†çš„ä¿¡æ¯åˆ†å¸ƒäºå¤šä¸ªè¡Œä¸­ï¼Œéœ€è¦è€ƒè™‘å¤šè¡Œå¤„ç†å‘½ä»¤ï¼š<em>Nã€Pã€D</em>ã€‚<em><a href="http://www.grymoire.com/Unix/Sed.html#uh-51">click here, nice tutorial</a></em></p>

<p>è€ƒè™‘ä»¥ä¸‹æƒ…æ™¯ï¼š</p>

<pre><code>% cat onetwo                                                                            
one two onw two one two xxx one
two yyy one
two zzz one    
two kkk two one
twx xxx yyy one two one
xxxxx
xxx

yyy one 
x two one
xx one

two x
x one
two one
two
</code></pre>

<p>å¦‚æœä¸€è¡Œä»¥ <em>one</em> ç»“å°¾ï¼Œè€Œä¸”ä¸‹ä¸€è¡Œä»¥ <em>two</em> å¼€å¤´ï¼Œé‚£ä¹ˆå°±æŠŠè¿™ä¸¤ä¸ªé‚»æ¥è¡Œæ‹¼æ¥æˆä¸€è¡Œï¼Œå¹¶æŠŠ <em>one two</em> æ›¿æ¢ä¸º <em>1 2</em>ã€‚</p>

<p>åœ¨åªäº†è§£ <em>Nã€Pã€D</em> ä¹‹åï¼Œæƒ³å‡ºä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„è§£å†³æ–¹æ¡ˆï¼š</p>

<pre><code>% cat onetwo.sed
#!/usr/bin/sed -f
/one *$/ {
        # è¿æ¥ä¸‹ä¸€è¡Œï¼Œ$!N è¡¨ç¤ºå¦‚æœè¯»åˆ°æœ€åä¸€è¡Œå•ç‹¬å¤„ç† 
        $!N
        # æ›¿æ¢ prefix + one + å›è½¦ç¬¦ + two ä¸º å›è½¦ç¬¦ + prefix + 1 2
        s/^\(.*\)one *\ntwo/\
\11 2/
        /^\n/ !P
        D
}
</code></pre>

<p>è¡¨è¾¾å¼ <em>s/a/b/</em> ä¸­ï¼ŒæŸ¥æ‰¾å­—ç¬¦ä¸² <em>a</em> å¦‚æœåŒ…å«å›è½¦ç¬¦ï¼Œç”¨ <code>\n</code> è¡¨ç¤ºã€‚ä½†æ˜¯å¦‚æœæ›¿æ¢å­—ç¬¦ä¸² <em>b</em> ä¸­å¦‚æœåŒ…å«å›è½¦ç¬¦ï¼Œéœ€è¦ç”¨ <code>\ + å›è½¦</code> è¡¨ç¤ºã€‚å¹¶ä¸”å›è½¦åçš„æ›¿æ¢å†…å®¹è¦é¡¶å¤´ï¼Œä¸èƒ½æ’ç‰ˆåŠ ç©ºæ ¼ã€tab<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>ã€‚</p>

<p>ä»¥ä¸Šè§£å†³æ–¹æ¡ˆçš„å…³é”®ç‚¹åœ¨äºæ›¿æ¢æ—¶åœ¨å¼€å¤´åˆåŠ äº†ä¸€ä¸ª<strong>æ¢è¡Œç¬¦</strong>ï¼Œå¦‚æ­¤åé¢æ‰§è¡Œ <em>D</em> åˆ™åˆ é™¤äº†æ¨¡å¼ç©ºé—´ä¸­çš„è¿™ä¸ª<strong>ç©ºè¡Œ</strong>ï¼Œç»§ç»­è¯»å…¥ä¸‹ä¸€è¡Œå¤„ç†ï¼Œä»¥æ­¤è¾¾åˆ°å¾ªç¯å¤„ç†çš„ç›®çš„ã€‚</p>

<pre><code>% ./onetwo.sed onetwo
one two onw two one two xxx 1 2 yyy 1 2 zzz 1 2 kkk two one
twx xxx yyy one two one
xxxxx
xxx

yyy one 
x two one
xx one

two x
x 1 2 1 2
</code></pre>

<p>åé¢äº†è§£äº† <em>t</em> å‘½ä»¤åï¼Œæ›´ç›´æ¥çš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>

<pre><code>% cat onetwot.sed     
#!/bin/bash 
sed  '
/one/ {
        :again
                $!N
                s/one *\ntwo/1 2/
                t again

}
' $1
</code></pre>

<p><em>t</em> å‘½ä»¤ç›¸å½“äºä¸€ä¸ª <em>while</em>ï¼Œå½“ <em>t</em> ä¹‹å‰æœ€è¿‘çš„ä¸€ä¸ª <em>s/a/b/</em> å‘½ä»¤åŒ¹é…æˆåŠŸæ—¶ï¼Œç»§ç»­å¾ªç¯ã€‚å¾—åˆ°åŒæ ·çš„è¿è¡Œç»“æœã€‚</p>

<p>æ­¤å°å®ä¾‹åªåšè¶£å‘³è®¨è®ºï¼Œ<em>shell</em> ä¸­çš„æµå¤„ç†<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>éƒ½æ˜¯é¢å‘<em>è¡Œ</em><sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>ä¸ºå•ä½çš„ï¼Œå¯¹äºå†…å®¹æœ‰ overlap çš„å¾ªç¯å¤„ç†ï¼Œæ•ˆç‡ä½ä¸”ä¸å¥½ç”¨ã€‚</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>å–å†³äºä¸åŒçš„ sed ç‰ˆæœ¬ï¼Œä½†æ˜¯é¡¶å¤´å†™è‚¯å®šæ˜¯ ok çš„ã€‚<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>sed, awk, grep etc..<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>or å—ï¼Œæ¯”å¦‚ awk ä¸­çš„ FS=&lsquo;\n&rsquo;<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MySQL5.5 ä»¥ä¸‹ç‰ˆæœ¬é€šè¿‡ Java è½¬ä¹‰å®ç° Emoji å­˜å–]]></title>
    <link href="http://hedleyyan.github.io/blog/2015/08/05/mysql5-dot-5-yi-xia-ban-ben-tong-guo-java-zhuan-yi-shi-xian-emoji-cun-qu/"/>
    <updated>2015-08-05T22:41:19+08:00</updated>
    <id>http://hedleyyan.github.io/blog/2015/08/05/mysql5-dot-5-yi-xia-ban-ben-tong-guo-java-zhuan-yi-shi-xian-emoji-cun-qu</id>
    <content type="html"><![CDATA[<p>æˆ‘ä¸è¾“å‡ºå¥½æ–‡ï¼Œæˆ‘åªæ˜¯å¥½æ–‡çš„æ¬è¿å·¥ã€‚<a href="http://cenalulu.github.io/linux/character-encoding">ååˆ†é’Ÿææ¸…å­—ç¬¦é›†å’Œå­—ç¬¦ç¼–ç </a>å¸¦ä½ èµ°è¿› <em>Unicode</em> å’Œ <em>UTF-8</em> çš„å‰ä¸–ä»Šç”Ÿã€‚æ€»è€Œè¨€ä¹‹ï¼Œ<em>Unicode</em> æ˜¯æ ‡å‡†ï¼Œ<em>UTF-8</em> æ˜¯å®ç°ã€‚</p>

<h2>MySQL è¿‡æ‹› <em>Emoji</em></h2>

<p>é€šå¸¸ MySQL çš„é»˜è®¤å­—ç¬¦é›†éƒ½ä¼šé…ç½®ä¸º <em>UTF-8</em>ï¼Œåªæ”¯æŒå•å­—ç¬¦ä¸è¶…è¿‡ 3 bytes çš„å­˜å‚¨<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>ã€‚å¸¸è§çš„ <em><a href="https://en.wikipedia.org/wiki/Emoji">Emoji</a></em> çš„ <em>Unicode</em> ç¼–ç å€¼ <em>code point</em> ä½äº <code>\u1F601 -- \u1F64F</code> åŒºé—´ï¼Œä»¥ <code>\u1F300</code> ã€ğŸŒ€ã€ä¸¾ä¾‹ï¼Œå®ƒçš„äºŒè¿›åˆ¶æœ‰ 17 ä½ï¼Œæ— æ³•ç”¨ä¸‰å­—èŠ‚çš„ <em>UTF-8</em> ç¼–ç è¡¨ç¤º<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>ã€‚å¦‚æœé€šè¿‡ JDBC å°†æ­¤å­—ç¬¦å°è¯•æ’å…¥ MySQL è®°å½•ä¸­ï¼Œä¼šå¾—åˆ°ä»¥ä¸‹å¼‚å¸¸</p>

<pre><code>java.lang.RuntimeException: java.sql.SQLException: Incorrect string value: '\xF0\x9F\x8C\x80' for column 'message' at row 1 
</code></pre>

<h2>Java è¿‡æ‹› <em>Emoji</em></h2>

<p>Java å­˜å‚¨å­—ç¬¦çš„å•å…ƒæ˜¯ <code>char</code>ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œ16 ä½çš„ <code>char</code> å¦‚ä½• handle 17 ä½çš„ <em>Unicode</em> å‘¢ï¼Ÿ</p>

<p><img src="/images/doughnut.png"></p>

<p>å–œé—»ä¹è§ï¼ŒJava çš„å•ä¸ª <code>char</code> ç¡®å®æ— æ³• handle ğŸŒ€ã€‚é‚£ä¹ˆ âš¡ ä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Ÿç›¸ä¿¡èªæ˜å¦‚ä½ ï¼Œä¸€å®šå¯ä»¥æŸ¥åˆ° âš¡ çš„ <em>Unicode</em> æ˜¯ <code>\u26A1</code>ï¼ŒTada ~~ æ‰€ä»¥ âš¡ æ’å…¥æ•°æ®åº“ä¸­ä¹Ÿæ˜¯å¦¥å¦¥çš„ã€‚</p>

<p>é€Ÿå…¥ <a href="http://www.czyborra.com/utf/#Java">Java&rsquo;s Unicode Notation</a> ç§‘æ™®ä¸€ä¸‹ Java å¯¹ <em>Unicode</em> çš„æ”¯æŒå®ç°ï¼Œé…åˆ<a href="http://chenbochiuan.vip.blog.163.com/blog/static/172332969201072784730795/">é€šä¿—æ˜“æ‡‚ç‰ˆ</a>æ›´èµ<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>ã€‚åŸæ¥ Java å­˜å‚¨å•ä¸ªå­—ç¬¦çš„æœ€å°å•å…ƒå¹¶ä¸ä¸€å®šæ˜¯å•ä¸ª <code>char</code>ï¼Œè€Œæ˜¯æ ¹æ® <em>code point</em> çš„èŒƒå›´ç¡®å®šã€‚å¦‚æœå­—ç¬¦ <code>c</code> çš„ <em>code point</em> äºŒè¿›åˆ¶è¡¨ç¤ºä¸è¶…è¿‡ 16 ä½é‚£ä¹ˆå•ä¸ª <code>char</code> å¯ç›´æ¥è¡¨ç¤º<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup>ï¼›å¦åˆ™è¦è¿›è¡Œä»¥ä¸‹å¤„ç†ï¼Œä»¥ ğŸŒ€ ä¸¾ä¾‹</p>

<ul>
<li>æŠŠ <code>\u1F300</code> çš„äºŒè¿›åˆ¶è¡¨ç¤º <code>0001 11110011 00000000</code>ï¼Œå…¶é«˜ 10 ä½ä¸ä½ 10 ä½æ‹†å¼€å¤‡ç”¨</li>
<li>é«˜ä½åç§»é‡ W1 : <code>0xD7C0</code> ä¸ä½ä½åç§»é‡ W2 : <code>0xDC00</code> åˆ†åˆ«ä¸å…¶é«˜ä½ 10 ä½ç›¸åŠ å¤„ç†ï¼Œå¾—åˆ° <code>\uD83C</code> ä¸ <code>\uDF00</code><sup id="fnref:5"><a href="#fn:5" rel="footnote">5</a></sup></li>
<li>ä¸¤ä¸ªå­—ç¬¦æ‹¼æ¥ <code>\uD83C\uDF00</code> å¾—åˆ° ğŸŒ€</li>
</ul>


<p><figure class='code'><figcaption><span> (EmojiCharacter.java)</span> <a href='/downloads/code/EmojiCharacter.java'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">package</span> <span class="n">unicode</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmojiCharacter</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// high offset</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">W1</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="s">&quot;D7C0&quot;</span><span class="o">,</span><span class="mi">16</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// low offset</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">W2</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="s">&quot;DC00&quot;</span><span class="o">,</span><span class="mi">16</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="c1">// ğŸŒ€çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²è¡¨ç¤º</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">doughnutBinary</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="s">&quot;1F300&quot;</span><span class="o">,</span><span class="mi">16</span><span class="o">));</span>
</span><span class='line'>        <span class="c1">// æ‹†æˆé«˜ä½ 10 ä½è¡¨ç¤º</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">highSetsBinary</span> <span class="o">=</span> <span class="n">doughnutBinary</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">doughnutBinary</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">10</span><span class="o">);</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">lowSetsBinary</span> <span class="o">=</span> <span class="n">doughnutBinary</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">doughnutBinary</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">10</span><span class="o">,</span> <span class="n">doughnutBinary</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">highSetsBinary</span><span class="o">);</span>     <span class="c1">//    1111100</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lowSetsBinary</span><span class="o">);</span>      <span class="c1">//    1100000000</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// åˆ†åˆ«ä¸åç§»é‡ç›¸åŠ ï¼Œå¾—åˆ°ä¸¤ä¸ªç¼–ç å€¼</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">highSetsHexFixed</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">W1</span> <span class="o">+</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">highSetsBinary</span><span class="o">,</span> <span class="mi">2</span><span class="o">));</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">lowSetsHexFixed</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">W2</span> <span class="o">+</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">lowSetsBinary</span><span class="o">,</span> <span class="mi">2</span><span class="o">));</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">highSetsHexFixed</span><span class="o">);</span>   <span class="c1">//    d83c</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lowSetsHexFixed</span><span class="o">);</span>    <span class="c1">//    df00</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// æ‹¼æ¥è¿™ä¸¤ä¸ªç¼–ç å€¼ï¼Œè¿˜åŸå­—ç¬¦è¡¨ç¤º</span>
</span><span class='line'>        <span class="kt">char</span> <span class="n">highChar</span> <span class="o">=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">highSetsHexFixed</span><span class="o">,</span> <span class="mi">16</span><span class="o">).</span><span class="na">intValue</span><span class="o">();</span>
</span><span class='line'>        <span class="kt">char</span> <span class="n">lowChar</span> <span class="o">=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">lowSetsHexFixed</span><span class="o">,</span> <span class="mi">16</span><span class="o">).</span><span class="na">intValue</span><span class="o">();</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">highChar</span><span class="o">);</span>           <span class="c1">//    ?     </span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lowChar</span><span class="o">);</span>            <span class="c1">//    ?</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">highChar</span> <span class="o">+</span> <span class="s">&quot;&quot;</span> <span class="o">+</span> <span class="n">lowChar</span><span class="o">);</span>    <span class="c1">//    ğŸŒ€</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<h2>åˆä½“</h2>

<p>Client å‘é€ <em>Emoji</em> åˆ°åå°ï¼ŒJava å´æ— æ³•é€šè¿‡ JDBC å°†å…¶å­˜å‚¨åˆ° MySQLã€‚å¦‚æœæˆ‘ä»¬éµå¾ªæŸä¸ªç‰¹å®šçš„è½¬æ¢è§„åˆ™ï¼Œå­˜å‚¨å‰è½¬ä¹‰ä¸€æ¬¡ï¼Œè¯»å–æ—¶å†é€†è½¬ä¹‰ä¸€æ¬¡ï¼Œé‚£ä¸å°±å¦¥å¦¥å¦¥çš„äº†ã€‚ä½ å½“ç„¶å¯ä»¥è‡ªå·±å†™ï¼Œä½†æ˜¯æ‡’é€¼å¦‚æˆ‘ï¼Œæ›´å€¾å‘äºæ‰¾<a href="https://github.com/vdurmont/emoji-java/">ç°è´§</a>ã€‚</p>

<h2>å¼•ç”¨</h2>

<ul>
<li><a href="http://cenalulu.github.io/linux/character-encoding">ååˆ†é’Ÿææ¸…å­—ç¬¦é›†å’Œå­—ç¬¦ç¼–ç </a></li>
<li><a href="http://www.czyborra.com/utf/#Java">Java&rsquo;s Unicode Notation</a></li>
<li><a href="http://stackoverflow.com/questions/2220366/get-unicode-value-of-a-character">Get unicode value of a character</a></li>
<li><a href="http://stackoverflow.com/questions/6617491/how-to-convert-a-string-representation-of-unicode-hex-0x20000-to-the-int-code">Get character of a unicode value</a></li>
<li><a href="http://code.iamcal.com/php/emoji/">Full Emoji Catalog</a></li>
<li><a href="https://github.com/vdurmont/emoji-java/">emoji-java</a></li>
</ul>

<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>MySQL5.5 ç‰ˆæœ¬ä»¥åæœ‰å¯¹ <em>4 bytes</em> å•å­—ç¬¦çš„åŸç”Ÿæ”¯æŒï¼Œå­—ç¬¦é›†é…ç½®ä¸º <em>utf8mb4</em><a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>è¯·çœ‹ååˆ†é’Ÿç³»åˆ—çš„å®ç°ç»†èŠ‚ï¼Œä¸‰å­—èŠ‚çš„ <em>UTF-8</em> ç¼–ç ä¸Šé™æ˜¯ 16 ä½ã€4 + 6 + 6ã€ï¼Œ<code>11111 001100 000000</code> å¯¹åº”çš„ <em>UTF-8</em> ç¼–ç ä¸º <code>11110000 10011111 10001100 10000000</code>ï¼Œå³ <strong>\xF0</strong>&hellip;ï¼ŒMySQL ç»å¸¸ä¼šå†’å‡ºè¿™ç§å¼‚å¸¸<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>å‹˜è¯¯ï¼Œé€šä¿—ç‰ˆä¸­æ‰€è¯´çš„ W1 : <code>0xD800</code> ä¸å¯¹ï¼Œåº”æ˜¯ <code>0xD7C0</code>ï¼Œå·²åœ¨è¯„è®ºä¸­åæ˜ ç»™åŸä½œè€…<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
<li id="fn:4">
<p>æ¯”å¦‚ã€âš¡ã€<a href="#fnref:4" rev="footnote">&#8617;</a></p></li>
<li id="fn:5">
<p><em>Unicode</em> é¢„ç•™äº†æ›¿ä»£åŒºåŸŸ <code>\uD800 -- \uDFFF</code> ä½œä¸ºè¾…åŠ©ï¼Œæ­¤åŒºé—´çš„å•ä¸ªå­—ç¬¦æ²¡æœ‰å®é™…è¡¨ç¤ºæ„ä¹‰<a href="#fnref:5" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sublime Text å…‰æ ‡ç„¦ç‚¹é›†ä¸­åˆ° FOLDERS çŠ¶æ€æ ]]></title>
    <link href="http://hedleyyan.github.io/blog/2015/06/29/sublime-text-guang-biao-jiao-dian-ji-zhong-dao-folders-zhuang-tai-lan/"/>
    <updated>2015-06-29T14:03:36+08:00</updated>
    <id>http://hedleyyan.github.io/blog/2015/06/29/sublime-text-guang-biao-jiao-dian-ji-zhong-dao-folders-zhuang-tai-lan</id>
    <content type="html"><![CDATA[<p>æœç´¢äº†è‹¥å¹²èµ„æ–™ï¼Œå¦‚ä½•è®©å…‰æ ‡ç„¦ç‚¹ä» Editor ç§»åŠ¨åˆ° FOLDERS çŠ¶æ€æ ã€‚å¶ç„¶å¤ç°è¿‡ä¸€æ¬¡ï¼Œå´ç™¾æ€ä¸å¾—å…¶è§£ã€‚</p>

<p>ç»è¿‡ä¸æ‡ˆå°è¯•ï¼Œç»ˆå¾—ç ´è§£å¤§æ³•ï¼è¿™ä¸‹ä¸€å£æ°”çœ‹ LOG ä¸è¦å¤ªçˆ½ï¼</p>

<ul>
<li>ç‚¹å‡» FOLDERS ä¸­ä»»æ„ä¸€ä¸ªæ–‡ä»¶</li>
<li>å†æ¬¡å·¦é”®ç‚¹å‡»è¿™ä¸ªæ–‡ä»¶ï¼Œä¸è¦æ¾å¼€ï¼Œç´§æ¥ç€ç‚¹å‡»å³é”®</li>
<li>Bingoï¼</li>
</ul>


<p><strong>ç§˜ç±</strong>ï¼šå·¦ C + [ å·¦ C + hold 2ms + å³ C ]ï¼Œå¾ˆæœ‰æˆ‘å½“å¹´ä¸‰å›½æˆ˜è®°é…æ— é™é£ä¹¦çš„ç¥éŸµå•Šï¼</p>

<p><img src="/images/fengshu.jpg"></p>

<!--more-->

]]></content>
  </entry>
  
</feed>
