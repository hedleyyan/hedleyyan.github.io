<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: è§„çº¦ | Hedley]]></title>
  <link href="http://hedleyyan.github.io/tags/gui-yue/atom.xml" rel="self"/>
  <link href="http://hedleyyan.github.io/"/>
  <updated>2016-01-15T15:30:21+08:00</updated>
  <id>http://hedleyyan.github.io/</id>
  <author>
    <name><![CDATA[hedley]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Java å¦‚ä½•å®ç° Prototype Pattern]]></title>
    <link href="http://hedleyyan.github.io/blog/2015/08/18/prototype-pattern/"/>
    <updated>2015-08-18T14:53:29+08:00</updated>
    <id>http://hedleyyan.github.io/blog/2015/08/18/prototype-pattern</id>
    <content type="html"><![CDATA[<p>çœ‹åˆ°  <a href="https://books.google.com.hk/books?id=FqfKFl4Bm7UC&amp;printsec=frontcover&amp;dq=software+architecture+design+patterns+in+java&amp;hl=en&amp;sa=X&amp;ved=0CB0Q6AEwAGoVChMIktPB556yxwIVhBcsCh3h_wwt#v=onepage&amp;q&amp;f=false">Software Architecture Design Patterns in Java</a> çš„ <em>CREATIONAL PATTERNS: Prototype</em> <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>ç« èŠ‚ï¼Œå¿½æ„Ÿä¸€é˜µææƒšã€‚ä¹‹å‰å†™<a href="/blog/2015/07/18/fu-ze-ren-zai-tan-callback-yu-delegation/">è´Ÿè´£ä»»å†è°ˆ Callback ä¸ Delegation</a> æ—¶æåˆ°äº† <strong>Java ä¸æ”¯æŒ Delegation</strong>ï¼Œä½†æ˜¯è¿™ç¯‡è®¾è®¡æ¨¡å¼å´å¥½åƒå†™å¦‚ä½•åœ¨ Java ä¸­å®ç° <em>Delegation</em>ã€‚æ­¤ä¸­æ¶‰åŠäº† <code>Object.clone()</code> æ–¹æ³•ã€<code>Cloneable</code> æ¥å£ï¼ŒçœŸçœŸä¸€å›¢ä¹±éº»ã€‚</p>

<h2>Prototype Pattern</h2>

<p>å…ˆçœ‹ <em>Prototype Pattern</em> çš„ <a href="https://en.wikipedia.org/wiki/Prototype_pattern">Wiki</a>ï¼Œä¸€å¼€å§‹æåˆ°çš„ä¾¿æ˜¯ <em>Not to be confused with Prototype-based programming</em>ï¼Œ<em>Delegation</em> æ­£æ˜¯ <em>Prototype-based programming</em> çš„è¯­è¨€ç‰¹æ€§<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>ã€‚æ€»ä¹‹ï¼Œ<em>Prototype Pattern</em> æ˜¯åˆ›å»ºå¯¹è±¡çš„ä¸€ç§æ–¹æ³•ï¼Œ<em>Delegation</em> æ˜¯è¯­è¨€çš„ä¸€ç§å¤©èµ‹ã€‚</p>

<h2>clone() &amp;&amp; Cloneable Interface</h2>

<p>äº†è§£ <code>clone</code> ä¹‹å‰ï¼Œçœ‹ <a href="https://books.google.com.hk/books?id=ka2VUBqHiWkC&amp;pg=PA54&amp;dq=Item+11:+OVERRIDE+CLONE+JUDICIOUSLY&amp;hl=en&amp;sa=X&amp;ved=0CB0Q6AEwAGoVChMI9vu89beyxwIVClssCh21QQYo#v=onepage&amp;q=Item%2011%3A%20OVERRIDE%20CLONE%20JUDICIOUSLY&amp;f=false">Effective Java, Item 11: Override clone judiciously</a> æ˜¯å¿…ä¿®è¯¾ï¼</p>

<p>éšä¾¿ç¿»çœ‹å‡ ä¸ª Java å®ç° <em>Prototype Pattern</em> çš„ä¾‹å­ã€<a href="http://www.blackwasp.co.uk/Prototype.aspx">æˆ³è¿™é‡Œ</a>ã€<a href="http://www.tutorialspoint.com/design_pattern/prototype_pattern.htm">æˆ³è¿™é‡Œ</a>ã€<a href="http://howtodoinjava.com/2013/01/04/prototype-design-pattern-in-java/">æˆ³è¿™é‡Œ</a>ã€ï¼Œä¹ŸåŒ…æ‹¬æœ€å¼€å§‹æåˆ°çš„ <em>CREATIONAL PATTERNS: Prototype</em>ï¼Œéƒ½æ˜¯é€šè¿‡ <code>Object</code> åŸºç±»ä¸­çš„ <code>clone()</code> æ–¹æ³•ç›´æ¥æˆ–é—´æ¥å®ç°çš„ã€‚</p>

<p><code>clone()</code> æ–¹æ³•æ˜¯åŸç”Ÿæ–¹æ³•ï¼Œå®ƒç±»ä¼¼ <code>new</code>ï¼Œä¼šç”Ÿæˆæ–°å¯¹è±¡ï¼Œä¹Ÿæ˜¯ä¸€ç§â€œæ„é€ æ–¹æ³•â€ï¼Œæ‰€ä»¥å¯¹æ„é€ æ–¹æ³•çš„ä¸€äº›çº¦æŸå¯¹å…¶åŒæ ·é€‚ç”¨<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>ã€‚</p>

<p><code>clone()</code> æ–¹æ³•æ˜¯ <code>protected</code> æ–¹æ³•ï¼Œæƒ³è¦è°ƒç”¨ä¹‹è¿˜éœ€è¦ç»‘å®š <code>Cloneable</code> æ¥å£ã€‚è¿™ä¸ªå¥‡è‘©è®¾å®šå¾ˆæ¶å¿ƒï¼Œè™½è¯´<strong>çº¦å®šä¼˜äºé…ç½®</strong>ï¼Œä½†è¿™ç§çº¦å®šå®åœ¨æ˜¯å¤ªä¸ä¼˜é›…ã€‚æŒ‰ç…§åœ°çƒäººçš„ç†è§£ï¼Œä¸€ä¸ªæ¥å£åº”è¯¥æä¾›ä¸€ç§æœåŠ¡ï¼Œ<code>Cloneable</code> æ¥å£æä¾› <code>clone()</code> æ–¹æ³•å¤©ç»åœ°ä¹‰ï¼Œä½†åˆç”±äºå…¶ç‰¹æ®Šæ€§ï¼Œ<code>clone()</code> æ–¹æ³•çš„åŸç”Ÿå®ç° Java éœ€è¦è‡ªå·±æä¾›ï¼Œè€Œæ¥å£å£°æ˜çš„æ–¹æ³•åˆä¸èƒ½ç»™å‡ºä¸€ä¸ªé»˜è®¤å®ç°<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup>ï¼Œç„¶åè¿™ä¸ª <code>clone()</code> æ–¹æ³•ä¾¿å†™åœ¨äº† <code>Object</code> é‡Œï¼Œ<code>Cloneable</code> æ¥å£åªæ˜¯ä½œä¸ºä¸€ä¸ªæ ‡è¯†æ¥å£ç”¨ï¼šæ‰€æœ‰å®ç°äº† <code>Cloneable</code> çš„ç±»éœ€è¦é‡å†™ <code>clone()</code> æ–¹æ³•ï¼Œé€šè¿‡ <code>super.clone()</code> æ¥è°ƒç”¨ <code>Object.clone()</code> çš„åŸç”Ÿå®ç°ï¼Œç„¶åæ ¹æ®éœ€è¦å†åšä¸€äº›é€‚å½“çš„è°ƒæ•´ã€‚</p>

<p>æ‰€è°“é€‚å½“çš„è°ƒæ•´ï¼Œæ˜¯å› ä¸º <code>Object</code> çš„ <code>clone()</code> æ–¹æ³•åªæ˜¯ <em>shallow copy</em>ï¼Œå¦‚æ­¤ <em>clone</em> å‡ºæ¥çš„å¯¹è±¡ï¼Œå…¶åŒ…å«çš„ <em>mutable</em> çš„å¼•ç”¨è¿˜æ˜¯åŒä¸€ä¸ªå¼•ç”¨ï¼Œå¹¶éå‰¯æœ¬ã€‚</p>

<p><blockquote><p>By convention, the object returned by this method should be independent of this object (which is being cloned). To achieve this independence, it may be necessary to modify one or more fields of the object returned by super.clone before returning it. Typically, this means copying any mutable objects that comprise the internal &ldquo;deep structure&rdquo; of the object being cloned and replacing the references to these objects with references to the copies. If a class contains only primitive fields or references to immutable objects, then it is usually the case that no fields in the object returned by super.clone need to be modified.</p><footer><strong>Object.clone() è¯´æ˜</strong></footer></blockquote></p>

<p>äº†è§£äº†è¿™äº›ä¹‹åï¼Œä½ ä»¥ä¸ºå°±å¯ä»¥å¦¥å¦¥çš„ä½¿ç”¨ <code>clone()</code> äº†å—ï¼Ÿè¿˜è¦æ³¨æ„è¿™äº›é™åˆ¶</p>

<ul>
<li>All classes that implement Cloneable should override clone with a public method whose return type is the class itself.</li>
<li>If you override the clone method in a nonfinal class, you should return an object obtained by invoking super.clone. If all of a classâ€™s superclasses obey this rule, then invoking super.clone will eventually invoke Objectâ€™s clone method, creating an instance of the right class.</li>
<li>In effect, the clone method functions as another constructor; you must ensure that it does no harm to the original object and that it properly establishes invariants on the clone.</li>
<li>Like a constructor, a clone method should not invoke any nonfinal methods on the clone under construction.</li>
<li>The clone architecture is incompatible with normal use of final fields referring to mutable objects.</li>
<li>Objectâ€™s clone method is declared to throw CloneNotSupportedException, but overriding clone methods can omit this declaration. Public clone methods should omit it because methods that donâ€™t throw checked exceptions are easier to use.</li>
<li>If you decide to make a thread-safe class implement Cloneable, remember that its clone method must be properly synchronized just like any other method.</li>
<li>Given all of the problems associated with Cloneable, itâ€™s safe to say that other interfaces should not extend it, and that classes designed for inheritance (Item 17) should not implement it.</li>
</ul>


<p>é‰´äºä»¥ä¸Šç§ç§ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆä¿å®ˆçš„è¯´ï¼šççˆ±ç”Ÿå‘½ï¼Œè¿œç¦» <em>clone()</em>ã€‚</p>

<h2>Copy Constructor || Copy Factory</h2>

<p>EJ ç»™å‡ºäº†ä¸€ç§æ›¿ä»£è§£å†³æ–¹æ¡ˆï¼šcopy constructor or copy factoryã€‚å®ƒå¯¹æ¯” <code>clone()</code> ç®€ç›´å¥½å¤„å¤šå¤šï¼šä¸éœ€è¦å—å¥‡è‘©è¯­æ„çº¦æŸã€ä¸ä¼šå’Œ <code>final</code> æ ‡è¯†çš„å±æ€§å†²çªã€ä¸æŠ›å‡ºæ— æ„ä¹‰çš„å¼‚å¸¸ã€ä¸éœ€è¦ç±»å‹è½¬æ¢ã€‚</p>

<p><img src="/images/copy_constructor.png"></p>

<p><em>copy constructor</em> æ¥å—çš„å‚æ•°æ˜¯å…¶è‡ªèº«å®ç°çš„æ¥å£ç±»å‹ï¼Œå®ƒä»¬å…¶å®ç±»å±äº <em>conversion constructor</em>ã€‚æ³¨æ„ <code>HashMap</code> ä¸ <code>Collection</code> çš„æ„é€ æ–¹æ³•é‡Œï¼Œéƒ½æœ‰è¿™ç§ <em>conversion constructor</em>ï¼Œä½†æ˜¯å®ƒä»¬éƒ½æ˜¯ <em>shallow copy</em>ã€‚</p>

<h2>åºåˆ—åŒ–ä»¥åŠå…¶ä»–</h2>

<p><a href="http://stackoverflow.com/questions/23892962/is-object-deserialization-a-proper-way-to-implement-prototype-pattern-in-java">Is Object deserialization a proper way to implement Prototype pattern in Java?</a> ç»†è‡´è®¨è®ºäº†é€šè¿‡åºåˆ—åŒ–å®ç° <em>Prototype Pattern</em> çš„å¯èƒ½æ€§ã€‚ç»“è®ºæ˜¯<strong>å¯ä»¥</strong>ï¼Œä½†ä»£ä»·æ˜¯å·¨å¤§çš„ï¼Œè¿˜ä¸å¦‚ <code>clone</code> å‘¢ï¼å…¶å® XMLã€JSON éƒ½å¯ä»¥ä½œä¸ºå®ç°åŸå‹æ¨¡å¼çš„æ‰‹æ®µï¼Œåªè¦èƒ½å¾—åˆ°ä¸€ä¸ªå¯¹è±¡çš„å‰¯æœ¬å°±è¡Œäº†å‘—ã€‚é—®é¢˜ä¸­çš„æ¯ä¸€ä¸ªå›ç­”æ¯ä¸€ä¸ªè¯„è®ºéƒ½å€¼å¾—ç»†ç»†å“å‘³ã€‚</p>

<p><img src="/images/kluge.png"></p>

<p><font size="8px"><strong>kluge</strong></font> [è‹±][k&#8217;lu:dÊ’] [ç¾][k&#8217;lu:dÊ’]  &nbsp;&nbsp; n.ç”±ä¸é…å¥—çš„å…ƒä»¶æ‹¼å‡‘è€Œæˆçš„è®¡ç®—æœºï¼Œå¼‚æœºç§ç³»ç»Ÿ</p>

<p><a href="http://stackoverflow.com/questions/665860/deep-clone-utility-recomendation/">Deep clone utility recomendation.</a> ç»™å‡ºäº†å®ç° <em>deep clone</em> çš„ä¸€ä¸ªå¼€æºç±»åº“ <em><a href="https://github.com/kostaskougios/cloning">The cloning library</a></em>ï¼Œæ­¤è´´å­çš„å›ç­”è¯„è®ºåŒæ ·ç²¾å½©ã€‚ç•¥çœ‹äº†ä¸€çœ¼ <em>The cloning library</em> çš„ç®€ä»‹å’Œè¯„ä»·ï¼ŒæœŸå¾…åº¦è¾ƒé«˜ï¼Œè²Œä¼¼æ˜¯é€šè¿‡åå°„å®ç°çš„ï¼Œç­‰æœ‰ç©ºç ”ç©¶ä¸€ä¸‹ä»£ç å†è¡¨ã€‚</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>Page 95.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>language feature<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>ä¸»è¦å°±æ˜¯è¿™ä¸€æ¡ï¼šNever call overridable methods from constructors, either directly or indirectly.<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
<li id="fn:4">
<p>JKD8 å¯ä»¥åšåˆ°ï¼Œå’‹ä¸æ—©å‡ºè¿™ä¸ªç‰¹æ€§å˜<a href="#fnref:4" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MySQL5.5 ä»¥ä¸‹ç‰ˆæœ¬é€šè¿‡ Java è½¬ä¹‰å®ç° Emoji å­˜å–]]></title>
    <link href="http://hedleyyan.github.io/blog/2015/08/05/mysql5-dot-5-yi-xia-ban-ben-tong-guo-java-zhuan-yi-shi-xian-emoji-cun-qu/"/>
    <updated>2015-08-05T22:41:19+08:00</updated>
    <id>http://hedleyyan.github.io/blog/2015/08/05/mysql5-dot-5-yi-xia-ban-ben-tong-guo-java-zhuan-yi-shi-xian-emoji-cun-qu</id>
    <content type="html"><![CDATA[<p>æˆ‘ä¸è¾“å‡ºå¥½æ–‡ï¼Œæˆ‘åªæ˜¯å¥½æ–‡çš„æ¬è¿å·¥ã€‚<a href="http://cenalulu.github.io/linux/character-encoding">ååˆ†é’Ÿææ¸…å­—ç¬¦é›†å’Œå­—ç¬¦ç¼–ç </a>å¸¦ä½ èµ°è¿› <em>Unicode</em> å’Œ <em>UTF-8</em> çš„å‰ä¸–ä»Šç”Ÿã€‚æ€»è€Œè¨€ä¹‹ï¼Œ<em>Unicode</em> æ˜¯æ ‡å‡†ï¼Œ<em>UTF-8</em> æ˜¯å®ç°ã€‚</p>

<h2>MySQL è¿‡æ‹› <em>Emoji</em></h2>

<p>é€šå¸¸ MySQL çš„é»˜è®¤å­—ç¬¦é›†éƒ½ä¼šé…ç½®ä¸º <em>UTF-8</em>ï¼Œåªæ”¯æŒå•å­—ç¬¦ä¸è¶…è¿‡ 3 bytes çš„å­˜å‚¨<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>ã€‚å¸¸è§çš„ <em><a href="https://en.wikipedia.org/wiki/Emoji">Emoji</a></em> çš„ <em>Unicode</em> ç¼–ç å€¼ <em>code point</em> ä½äº <code>\u1F601 -- \u1F64F</code> åŒºé—´ï¼Œä»¥ <code>\u1F300</code> ã€ğŸŒ€ã€ä¸¾ä¾‹ï¼Œå®ƒçš„äºŒè¿›åˆ¶æœ‰ 17 ä½ï¼Œæ— æ³•ç”¨ä¸‰å­—èŠ‚çš„ <em>UTF-8</em> ç¼–ç è¡¨ç¤º<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>ã€‚å¦‚æœé€šè¿‡ JDBC å°†æ­¤å­—ç¬¦å°è¯•æ’å…¥ MySQL è®°å½•ä¸­ï¼Œä¼šå¾—åˆ°ä»¥ä¸‹å¼‚å¸¸</p>

<pre><code>java.lang.RuntimeException: java.sql.SQLException: Incorrect string value: '\xF0\x9F\x8C\x80' for column 'message' at row 1 
</code></pre>

<h2>Java è¿‡æ‹› <em>Emoji</em></h2>

<p>Java å­˜å‚¨å­—ç¬¦çš„å•å…ƒæ˜¯ <code>char</code>ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œ16 ä½çš„ <code>char</code> å¦‚ä½• handle 17 ä½çš„ <em>Unicode</em> å‘¢ï¼Ÿ</p>

<p><img src="/images/doughnut.png"></p>

<p>å–œé—»ä¹è§ï¼ŒJava çš„å•ä¸ª <code>char</code> ç¡®å®æ— æ³• handle ğŸŒ€ã€‚é‚£ä¹ˆ âš¡ ä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Ÿç›¸ä¿¡èªæ˜å¦‚ä½ ï¼Œä¸€å®šå¯ä»¥æŸ¥åˆ° âš¡ çš„ <em>Unicode</em> æ˜¯ <code>\u26A1</code>ï¼ŒTada ~~ æ‰€ä»¥ âš¡ æ’å…¥æ•°æ®åº“ä¸­ä¹Ÿæ˜¯å¦¥å¦¥çš„ã€‚</p>

<p>é€Ÿå…¥ <a href="http://www.czyborra.com/utf/#Java">Java&rsquo;s Unicode Notation</a> ç§‘æ™®ä¸€ä¸‹ Java å¯¹ <em>Unicode</em> çš„æ”¯æŒå®ç°ï¼Œé…åˆ<a href="http://chenbochiuan.vip.blog.163.com/blog/static/172332969201072784730795/">é€šä¿—æ˜“æ‡‚ç‰ˆ</a>æ›´èµ<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>ã€‚åŸæ¥ Java å­˜å‚¨å•ä¸ªå­—ç¬¦çš„æœ€å°å•å…ƒå¹¶ä¸ä¸€å®šæ˜¯å•ä¸ª <code>char</code>ï¼Œè€Œæ˜¯æ ¹æ® <em>code point</em> çš„èŒƒå›´ç¡®å®šã€‚å¦‚æœå­—ç¬¦ <code>c</code> çš„ <em>code point</em> äºŒè¿›åˆ¶è¡¨ç¤ºä¸è¶…è¿‡ 16 ä½é‚£ä¹ˆå•ä¸ª <code>char</code> å¯ç›´æ¥è¡¨ç¤º<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup>ï¼›å¦åˆ™è¦è¿›è¡Œä»¥ä¸‹å¤„ç†ï¼Œä»¥ ğŸŒ€ ä¸¾ä¾‹</p>

<ul>
<li>æŠŠ <code>\u1F300</code> çš„äºŒè¿›åˆ¶è¡¨ç¤º <code>0001 11110011 00000000</code>ï¼Œå…¶é«˜ 10 ä½ä¸ä½ 10 ä½æ‹†å¼€å¤‡ç”¨</li>
<li>é«˜ä½åç§»é‡ W1 : <code>0xD7C0</code> ä¸ä½ä½åç§»é‡ W2 : <code>0xDC00</code> åˆ†åˆ«ä¸å…¶é«˜ä½ 10 ä½ç›¸åŠ å¤„ç†ï¼Œå¾—åˆ° <code>\uD83C</code> ä¸ <code>\uDF00</code><sup id="fnref:5"><a href="#fn:5" rel="footnote">5</a></sup></li>
<li>ä¸¤ä¸ªå­—ç¬¦æ‹¼æ¥ <code>\uD83C\uDF00</code> å¾—åˆ° ğŸŒ€</li>
</ul>


<p><figure class='code'><figcaption><span> (EmojiCharacter.java)</span> <a href='/downloads/code/EmojiCharacter.java'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">package</span> <span class="n">unicode</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmojiCharacter</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// high offset</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">W1</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="s">&quot;D7C0&quot;</span><span class="o">,</span><span class="mi">16</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// low offset</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">W2</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="s">&quot;DC00&quot;</span><span class="o">,</span><span class="mi">16</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="c1">// ğŸŒ€çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²è¡¨ç¤º</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">doughnutBinary</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="s">&quot;1F300&quot;</span><span class="o">,</span><span class="mi">16</span><span class="o">));</span>
</span><span class='line'>        <span class="c1">// æ‹†æˆé«˜ä½ 10 ä½è¡¨ç¤º</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">highSetsBinary</span> <span class="o">=</span> <span class="n">doughnutBinary</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">doughnutBinary</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">10</span><span class="o">);</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">lowSetsBinary</span> <span class="o">=</span> <span class="n">doughnutBinary</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">doughnutBinary</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">10</span><span class="o">,</span> <span class="n">doughnutBinary</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">highSetsBinary</span><span class="o">);</span>     <span class="c1">//    1111100</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lowSetsBinary</span><span class="o">);</span>      <span class="c1">//    1100000000</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// åˆ†åˆ«ä¸åç§»é‡ç›¸åŠ ï¼Œå¾—åˆ°ä¸¤ä¸ªç¼–ç å€¼</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">highSetsHexFixed</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">W1</span> <span class="o">+</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">highSetsBinary</span><span class="o">,</span> <span class="mi">2</span><span class="o">));</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">lowSetsHexFixed</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">W2</span> <span class="o">+</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">lowSetsBinary</span><span class="o">,</span> <span class="mi">2</span><span class="o">));</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">highSetsHexFixed</span><span class="o">);</span>   <span class="c1">//    d83c</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lowSetsHexFixed</span><span class="o">);</span>    <span class="c1">//    df00</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// æ‹¼æ¥è¿™ä¸¤ä¸ªç¼–ç å€¼ï¼Œè¿˜åŸå­—ç¬¦è¡¨ç¤º</span>
</span><span class='line'>        <span class="kt">char</span> <span class="n">highChar</span> <span class="o">=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">highSetsHexFixed</span><span class="o">,</span> <span class="mi">16</span><span class="o">).</span><span class="na">intValue</span><span class="o">();</span>
</span><span class='line'>        <span class="kt">char</span> <span class="n">lowChar</span> <span class="o">=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">lowSetsHexFixed</span><span class="o">,</span> <span class="mi">16</span><span class="o">).</span><span class="na">intValue</span><span class="o">();</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">highChar</span><span class="o">);</span>           <span class="c1">//    ?     </span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lowChar</span><span class="o">);</span>            <span class="c1">//    ?</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">highChar</span> <span class="o">+</span> <span class="s">&quot;&quot;</span> <span class="o">+</span> <span class="n">lowChar</span><span class="o">);</span>    <span class="c1">//    ğŸŒ€</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<h2>åˆä½“</h2>

<p>Client å‘é€ <em>Emoji</em> åˆ°åå°ï¼ŒJava å´æ— æ³•é€šè¿‡ JDBC å°†å…¶å­˜å‚¨åˆ° MySQLã€‚å¦‚æœæˆ‘ä»¬éµå¾ªæŸä¸ªç‰¹å®šçš„è½¬æ¢è§„åˆ™ï¼Œå­˜å‚¨å‰è½¬ä¹‰ä¸€æ¬¡ï¼Œè¯»å–æ—¶å†é€†è½¬ä¹‰ä¸€æ¬¡ï¼Œé‚£ä¸å°±å¦¥å¦¥å¦¥çš„äº†ã€‚ä½ å½“ç„¶å¯ä»¥è‡ªå·±å†™ï¼Œä½†æ˜¯æ‡’é€¼å¦‚æˆ‘ï¼Œæ›´å€¾å‘äºæ‰¾<a href="https://github.com/vdurmont/emoji-java/">ç°è´§</a>ã€‚</p>

<h2>å¼•ç”¨</h2>

<ul>
<li><a href="http://cenalulu.github.io/linux/character-encoding">ååˆ†é’Ÿææ¸…å­—ç¬¦é›†å’Œå­—ç¬¦ç¼–ç </a></li>
<li><a href="http://www.czyborra.com/utf/#Java">Java&rsquo;s Unicode Notation</a></li>
<li><a href="http://stackoverflow.com/questions/2220366/get-unicode-value-of-a-character">Get unicode value of a character</a></li>
<li><a href="http://stackoverflow.com/questions/6617491/how-to-convert-a-string-representation-of-unicode-hex-0x20000-to-the-int-code">Get character of a unicode value</a></li>
<li><a href="http://code.iamcal.com/php/emoji/">Full Emoji Catalog</a></li>
<li><a href="https://github.com/vdurmont/emoji-java/">emoji-java</a></li>
</ul>

<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>MySQL5.5 ç‰ˆæœ¬ä»¥åæœ‰å¯¹ <em>4 bytes</em> å•å­—ç¬¦çš„åŸç”Ÿæ”¯æŒï¼Œå­—ç¬¦é›†é…ç½®ä¸º <em>utf8mb4</em><a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>è¯·çœ‹ååˆ†é’Ÿç³»åˆ—çš„å®ç°ç»†èŠ‚ï¼Œä¸‰å­—èŠ‚çš„ <em>UTF-8</em> ç¼–ç ä¸Šé™æ˜¯ 16 ä½ã€4 + 6 + 6ã€ï¼Œ<code>11111 001100 000000</code> å¯¹åº”çš„ <em>UTF-8</em> ç¼–ç ä¸º <code>11110000 10011111 10001100 10000000</code>ï¼Œå³ <strong>\xF0</strong>&hellip;ï¼ŒMySQL ç»å¸¸ä¼šå†’å‡ºè¿™ç§å¼‚å¸¸<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>å‹˜è¯¯ï¼Œé€šä¿—ç‰ˆä¸­æ‰€è¯´çš„ W1 : <code>0xD800</code> ä¸å¯¹ï¼Œåº”æ˜¯ <code>0xD7C0</code>ï¼Œå·²åœ¨è¯„è®ºä¸­åæ˜ ç»™åŸä½œè€…<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
<li id="fn:4">
<p>æ¯”å¦‚ã€âš¡ã€<a href="#fnref:4" rev="footnote">&#8617;</a></p></li>
<li id="fn:5">
<p><em>Unicode</em> é¢„ç•™äº†æ›¿ä»£åŒºåŸŸ <code>\uD800 -- \uDFFF</code> ä½œä¸ºè¾…åŠ©ï¼Œæ­¤åŒºé—´çš„å•ä¸ªå­—ç¬¦æ²¡æœ‰å®é™…è¡¨ç¤ºæ„ä¹‰<a href="#fnref:5" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A Glossary of Name Reuse]]></title>
    <link href="http://hedleyyan.github.io/blog/2015/05/16/a-glossary-of-name-reuse/"/>
    <updated>2015-05-16T17:07:57+08:00</updated>
    <id>http://hedleyyan.github.io/blog/2015/05/16/a-glossary-of-name-reuse</id>
    <content type="html"><![CDATA[<p>æ­¤æ–‡å¤§æ¦‚å°±æ˜¯ã€ŠJava Puzzlersã€‹ä¸­ <em>Classier Pazzlers</em> ä¸€èŠ‚çš„ç®€å•ç¿»è¯‘å’Œæ•´ç†ï¼Œç²—ç•¥æ€»ç»“äº† <em>Java</em> æœ‰å…³<strong>å‘½åé‡å¤</strong>çš„åœºæ™¯å’Œä»£ç ç¤ºä¾‹ã€‚</p>

<h1>Overriding</h1>

<p><blockquote><p>An instance method overrides all accessible instance methods with the same signature in superclasses.</p><footer><strong>JLS 8.4.8.1</strong></footer></blockquote></p>

<p>é‡å†™çš„è§„èŒƒå®šä¹‰åŒ…æ‹¬ï¼š</p>

<ul>
<li>Context åŒ…æ‹¬ä¸¤ä¸ªç±»ï¼Œä¸€ä¸ªå­ç±»ï¼Œä¸€ä¸ªçˆ¶ç±»ã€‚</li>
<li>è½½ä½“å¿…é¡»æ˜¯å®ä¾‹æ–¹æ³• <em>(instance methods)</em>ï¼Œè€Œéé™æ€æ–¹æ³•ã€‚</li>
<li>å¿…é¡»æ˜¯åŒæ ·ç­¾å <em>(signature)</em> å’Œè¿”å›ç±»å‹ã€‚</li>
<li>é‡å†™æ–¹æ³•ä¸èƒ½ç¼©å°å¯è§èŒƒå›´ã€‚</li>
</ul>


<p>é‡å†™æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µï¼Œæ˜¯<strong>å”¯ä¸€</strong>é¼“åŠ±ä½¿ç”¨çš„ <em>Name Reuse</em> åœºæ™¯ã€‚</p>

<pre><code class="java">    class Base {
        protected void f() { }
    }

    class Derived extends Base {
        public void f() { } // overrrides Base.f()
    }
</code></pre>

<!--more-->


<h1>Overloading</h1>

<p><blockquote><p>Methods in a class overload one another if they have the same name and different signatures.</p><footer><strong>JLS 8.4.9</strong></footer></blockquote></p>

<p>é‡è½½å’Œé‡å†™æ˜¯ <em>Name Reuse</em> å‡ºç°æœ€å¤šçš„åœºæ™¯ã€‚ç›¸å¯¹äºé‡å†™ï¼Œé‡è½½è§„èŒƒåŒ…æ‹¬ï¼š</p>

<ul>
<li>Context åªæœ‰ä¸€ä¸ªç±»ã€‚</li>
<li>è½½ä½“å¯ä»¥æ˜¯å®ä¾‹æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ˜¯é™æ€æ–¹æ³•ã€‚</li>
<li>æ‹¥æœ‰ä¸åŒçš„ç­¾åã€‚</li>
</ul>


<pre><code class="java">    class CircuitBreaker {
        public void f(int i)    { }  // int overloading
        public void f(String s) { }  // String overloading
    } 
</code></pre>

<h1>Hiding</h1>

<p><blockquote><p>A field, static method, or member type hides all accessible fields, static methods, or member types, respectively, with the same name (or, for methods, signature) in supertypes. Hiding a member prevents it from being inherited.</p><footer><strong>JLS 8.3-8.5</strong></footer></blockquote></p>

<p><em>Hiding</em> å’Œ <em>Overriding</em> åœºæ™¯æ¯”è¾ƒåƒï¼Œ<em>Overriding</em> çš„è½½ä½“æ˜¯å®ä¾‹æ–¹æ³•ï¼Œè€Œ <em>Hiding</em> çš„è½½ä½“æ˜¯é™¤å»å®ä¾‹æ–¹æ³•ä»¥å¤–çš„å…¶ä»–æ‰€æœ‰å…ƒç´ ã€‚</p>

<ul>
<li>Context åŒ…æ‹¬å­ç±»å’Œçˆ¶ç±»ã€‚</li>
<li>è½½ä½“åŒ…æ‹¬å±æ€§ã€é™æ€æ–¹æ³•ã€æˆå‘˜ç±»ã€‚</li>
<li>åŒæ ·ç­¾åã€‚</li>
<li>å¯è§èŒƒå›´æ— çº¦æŸã€‚</li>
</ul>


<pre><code class="java">    class Base {
        public String className = "Base";
    }

    class Derived extends Base {
        private String className = "Derived";
    }

    public class PrivateMatter {
        public static void main(String[] args) {
            System.out.println(new Derived().className);
        }
    }
</code></pre>

<p>ï¸ï¸ï¸ä»£ç ç»“æœ</p>

<pre><code>PrivateMatter.java:11: className has private access in Derived
           System.out.println(new Derived().className);
</code></pre>

<p>å¾ˆæ˜æ˜¾ï¼Œ<em>Hiding</em> çš„ä»£ç æ˜¯æ™¦æ¶©éš¾æ‡‚çš„ï¼Œæ›´é‡è¦çš„æ˜¯å®ƒç ´åäº† <em>Liskov</em> æ›¿æ¢åŸåˆ™ã€‚åº”æåŠ›é¿å…è¿™ç§ <em>Name Reuse</em> åœºæ™¯ã€‚</p>

<p><blockquote><p>Everything you can do with a base class, you can also do with a derived class.</p><footer><strong>Liskov Substitution Principle</strong></footer></blockquote></p>

<h1><a name='shadowing'>Shadowing</a></h1>

<p><blockquote><p>A variable, method, or type shadows all variables, methods, or types, respectively, with the same name in a textually enclosing scope.</p><footer><strong>JLS 6.3.1</strong></footer></blockquote></p>

<ul>
<li>Context å¯èƒ½åªæœ‰ä¸€ä¸ªç±»ï¼Œä¹Ÿå¯èƒ½åŒ…æ‹¬åˆ«çš„å‡½æ•°åº“çš„ç±»ã€‚</li>
<li>è½½ä½“åŒ…æ‹¬å˜é‡ã€æ–¹æ³•ã€ç±»ã€ç±»å‹å£°æ˜ <em>(<T>)</em>ã€‚</li>
</ul>


<pre><code class="java">    class WhoKnows {
        static String sentence = "I donâ€™t know.";
        public static void main(String[] args) {
            String sentence = "I know!";   // shadows static field
            System.out.println(sentence);  // prints local variable
        }
    }
</code></pre>

<pre><code class="java">    public class StrungOut {
       public static void main(String[] args) {
           String s = new String("Hello world");
           System.out.println(s);
       }
    }

    class String {
        private final java.lang.String s;
        public String(java.lang.String s) {
            this.s = s;
        }
        public java.lang.String toString() {
            return s;
        } 
    }
</code></pre>

<p>ä»£ç ç»“æœ</p>

<pre><code>Exception in thread "main" java.lang.NoSuchMethodError: main
</code></pre>

<p>äº§ç”Ÿ <em>Shadowing</em> åœºæ™¯çš„ <em>Name Reuse</em> ï¼Œä¾æœ€è¿‘çš„ä½œç”¨åŸŸæ¥åˆ¤å®šæ˜¯å“ªä¸ªå…ƒç´ æœ‰æ•ˆã€‚</p>

<h1>Obscuring</h1>

<p><em>Obscuring</em> æ˜¯æŒ‡åœ¨ä½œç”¨åŸŸä¸­ï¼Œä¸€ä¸ªå˜é‡çš„åå­—å’Œä¸€ä¸ªç±»ç›¸åŒï¼Œç›´æ¥çœ‹ç¤ºä¾‹ä»£ç ã€‚</p>

<pre><code class="java">public class Obscure {
    static String System; // Obscures type java.lang.System
    public static void main(String[] args) {
        // Next line wonâ€™t compile:  System refers to static field 
        System.out.println("hello, obscure world!");
    }
}
</code></pre>

<p><blockquote><p>If a type or a package is obscured, you cannot refer to it by its simple name except in a context where the syntax allows only a name from its namespace.</p></blockquote></p>

<h1>å¸¸è§é™·é˜±</h1>

<h1>æ€»ç»“</h1>

<ol>
<li>é™¤äº† <em>Override</em> ï¼Œå°½é‡é¿å… <em>Name Reuse</em> ã€‚</li>
<li>éµå®ˆ <em>Java</em> å‘½åè§„åˆ™ï¼Œå¯ä»¥é¿å… <em>Obscuring</em> ã€‚</li>
<li>é¿å…å’Œ <code>java.lang</code> ç±»åº“ä¸­çš„å‘½åå†²çªã€‚</li>
</ol>


<!--é“¾æ¥-->

]]></content>
  </entry>
  
</feed>
